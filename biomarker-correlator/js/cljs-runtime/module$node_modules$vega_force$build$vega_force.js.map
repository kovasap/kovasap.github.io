{
"version":3,
"file":"module$node_modules$vega_force$build$vega_force.js",
"lineCount":10,
"mappings":"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",
"sources":["node_modules/vega-force/build/vega-force.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$vega_force$build$vega_force\"] = function(global,require,module,exports) {\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('vega-dataflow'), require('vega-util'), require('d3-force')) :\n  typeof define === 'function' && define.amd ? define(['exports', 'vega-dataflow', 'vega-util', 'd3-force'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory((global.vega = global.vega || {}, global.vega.transforms = {}), global.vega, global.vega, global.d3));\n}(this, (function (exports, vegaDataflow, vegaUtil, d3Force) { 'use strict';\n\n  const ForceMap = {\n    center: d3Force.forceCenter,\n    collide: d3Force.forceCollide,\n    nbody: d3Force.forceManyBody,\n    link: d3Force.forceLink,\n    x: d3Force.forceX,\n    y: d3Force.forceY\n  };\n  const Forces = 'forces',\n        ForceParams = ['alpha', 'alphaMin', 'alphaTarget', 'velocityDecay', 'forces'],\n        ForceConfig = ['static', 'iterations'],\n        ForceOutput = ['x', 'y', 'vx', 'vy'];\n  /**\n   * Force simulation layout.\n   * @constructor\n   * @param {object} params - The parameters for this operator.\n   * @param {Array<object>} params.forces - The forces to apply.\n   */\n\n  function Force(params) {\n    vegaDataflow.Transform.call(this, null, params);\n  }\n  Force.Definition = {\n    'type': 'Force',\n    'metadata': {\n      'modifies': true\n    },\n    'params': [{\n      'name': 'static',\n      'type': 'boolean',\n      'default': false\n    }, {\n      'name': 'restart',\n      'type': 'boolean',\n      'default': false\n    }, {\n      'name': 'iterations',\n      'type': 'number',\n      'default': 300\n    }, {\n      'name': 'alpha',\n      'type': 'number',\n      'default': 1\n    }, {\n      'name': 'alphaMin',\n      'type': 'number',\n      'default': 0.001\n    }, {\n      'name': 'alphaTarget',\n      'type': 'number',\n      'default': 0\n    }, {\n      'name': 'velocityDecay',\n      'type': 'number',\n      'default': 0.4\n    }, {\n      'name': 'forces',\n      'type': 'param',\n      'array': true,\n      'params': [{\n        'key': {\n          'force': 'center'\n        },\n        'params': [{\n          'name': 'x',\n          'type': 'number',\n          'default': 0\n        }, {\n          'name': 'y',\n          'type': 'number',\n          'default': 0\n        }]\n      }, {\n        'key': {\n          'force': 'collide'\n        },\n        'params': [{\n          'name': 'radius',\n          'type': 'number',\n          'expr': true\n        }, {\n          'name': 'strength',\n          'type': 'number',\n          'default': 0.7\n        }, {\n          'name': 'iterations',\n          'type': 'number',\n          'default': 1\n        }]\n      }, {\n        'key': {\n          'force': 'nbody'\n        },\n        'params': [{\n          'name': 'strength',\n          'type': 'number',\n          'default': -30\n        }, {\n          'name': 'theta',\n          'type': 'number',\n          'default': 0.9\n        }, {\n          'name': 'distanceMin',\n          'type': 'number',\n          'default': 1\n        }, {\n          'name': 'distanceMax',\n          'type': 'number'\n        }]\n      }, {\n        'key': {\n          'force': 'link'\n        },\n        'params': [{\n          'name': 'links',\n          'type': 'data'\n        }, {\n          'name': 'id',\n          'type': 'field'\n        }, {\n          'name': 'distance',\n          'type': 'number',\n          'default': 30,\n          'expr': true\n        }, {\n          'name': 'strength',\n          'type': 'number',\n          'expr': true\n        }, {\n          'name': 'iterations',\n          'type': 'number',\n          'default': 1\n        }]\n      }, {\n        'key': {\n          'force': 'x'\n        },\n        'params': [{\n          'name': 'strength',\n          'type': 'number',\n          'default': 0.1\n        }, {\n          'name': 'x',\n          'type': 'field'\n        }]\n      }, {\n        'key': {\n          'force': 'y'\n        },\n        'params': [{\n          'name': 'strength',\n          'type': 'number',\n          'default': 0.1\n        }, {\n          'name': 'y',\n          'type': 'field'\n        }]\n      }]\n    }, {\n      'name': 'as',\n      'type': 'string',\n      'array': true,\n      'modify': false,\n      'default': ForceOutput\n    }]\n  };\n  vegaUtil.inherits(Force, vegaDataflow.Transform, {\n    transform(_, pulse) {\n      var sim = this.value,\n          change = pulse.changed(pulse.ADD_REM),\n          params = _.modified(ForceParams),\n          iters = _.iterations || 300; // configure simulation\n\n\n      if (!sim) {\n        this.value = sim = simulation(pulse.source, _);\n        sim.on('tick', rerun(pulse.dataflow, this));\n\n        if (!_.static) {\n          change = true;\n          sim.tick(); // ensure we run on init\n        }\n\n        pulse.modifies('index');\n      } else {\n        if (change) {\n          pulse.modifies('index');\n          sim.nodes(pulse.source);\n        }\n\n        if (params || pulse.changed(pulse.MOD)) {\n          setup(sim, _, 0, pulse);\n        }\n      } // run simulation\n\n\n      if (params || change || _.modified(ForceConfig) || pulse.changed() && _.restart) {\n        sim.alpha(Math.max(sim.alpha(), _.alpha || 1)).alphaDecay(1 - Math.pow(sim.alphaMin(), 1 / iters));\n\n        if (_.static) {\n          for (sim.stop(); --iters >= 0;) sim.tick();\n        } else {\n          if (sim.stopped()) sim.restart();\n          if (!change) return pulse.StopPropagation; // defer to sim ticks\n        }\n      }\n\n      return this.finish(_, pulse);\n    },\n\n    finish(_, pulse) {\n      const dataflow = pulse.dataflow; // inspect dependencies, touch link source data\n\n      for (let args = this._argops, j = 0, m = args.length, arg; j < m; ++j) {\n        arg = args[j];\n\n        if (arg.name !== Forces || arg.op._argval.force !== 'link') {\n          continue;\n        }\n\n        for (var ops = arg.op._argops, i = 0, n = ops.length, op; i < n; ++i) {\n          if (ops[i].name === 'links' && (op = ops[i].op.source)) {\n            dataflow.pulse(op, dataflow.changeset().reflow());\n            break;\n          }\n        }\n      } // reflow all nodes\n\n\n      return pulse.reflow(_.modified()).modifies(ForceOutput);\n    }\n\n  });\n\n  function rerun(df, op) {\n    return () => df.touch(op).run();\n  }\n\n  function simulation(nodes, _) {\n    const sim = d3Force.forceSimulation(nodes),\n          stop = sim.stop,\n          restart = sim.restart;\n    let stopped = false;\n\n    sim.stopped = () => stopped;\n\n    sim.restart = () => (stopped = false, restart());\n\n    sim.stop = () => (stopped = true, stop());\n\n    return setup(sim, _, true).on('end', () => stopped = true);\n  }\n\n  function setup(sim, _, init, pulse) {\n    var f = vegaUtil.array(_.forces),\n        i,\n        n,\n        p,\n        name;\n\n    for (i = 0, n = ForceParams.length; i < n; ++i) {\n      p = ForceParams[i];\n      if (p !== Forces && _.modified(p)) sim[p](_[p]);\n    }\n\n    for (i = 0, n = f.length; i < n; ++i) {\n      name = Forces + i;\n      p = init || _.modified(Forces, i) ? getForce(f[i]) : pulse && modified(f[i], pulse) ? sim.force(name) : null;\n      if (p) sim.force(name, p);\n    }\n\n    for (n = sim.numForces || 0; i < n; ++i) {\n      sim.force(Forces + i, null); // remove\n    }\n\n    sim.numForces = f.length;\n    return sim;\n  }\n\n  function modified(f, pulse) {\n    var k, v;\n\n    for (k in f) {\n      if (vegaUtil.isFunction(v = f[k]) && pulse.modified(vegaUtil.accessorFields(v))) return 1;\n    }\n\n    return 0;\n  }\n\n  function getForce(_) {\n    var f, p;\n\n    if (!vegaUtil.hasOwnProperty(ForceMap, _.force)) {\n      vegaUtil.error('Unrecognized force: ' + _.force);\n    }\n\n    f = ForceMap[_.force]();\n\n    for (p in _) {\n      if (vegaUtil.isFunction(f[p])) setForceParam(f[p], _[p], _);\n    }\n\n    return f;\n  }\n\n  function setForceParam(f, v, _) {\n    f(vegaUtil.isFunction(v) ? d => v(d, _) : v);\n  }\n\n  exports.force = Force;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n\n};"],
"names":["shadow$provide","global","require","module","exports","factory","define","amd","globalThis","self","vega","transforms","d3","vegaDataflow","vegaUtil","d3Force","Force","params","Transform","call","rerun","df","op","touch","run","simulation","nodes","_","sim","forceSimulation","stop","restart","stopped","sim.stopped","sim.restart","sim.stop","setup","on","init","pulse","f","array","forces","n","i","ForceParams","length","p","Forces","modified","name","hasOwnProperty","ForceMap","force","error","isFunction","setForceParam","k","v","accessorFields","numForces","d","center","forceCenter","collide","forceCollide","nbody","forceManyBody","link","forceLink","x","forceX","y","forceY","ForceConfig","ForceOutput","Definition","inherits","transform","value","change","changed","ADD_REM","iters","iterations","modifies","source","MOD","dataflow","static","tick","alpha","Math","max","alphaDecay","pow","alphaMin","StopPropagation","finish","args","_argops","j","m","arg","_argval","ops","changeset","reflow","Object","defineProperty"]
}
